# Deployment Guide

## Deployment Options

Papers2Code can be deployed on multiple platforms:

### 1. Vercel + Render/Railway (Recommended for Production)
- **Frontend**: Vercel (optimal for React/Vite)
- **Backend**: Render or Railway (optimal for FastAPI)
- **Guide**: See [VERCEL_DEPLOYMENT.md](./VERCEL_DEPLOYMENT.md)
- **Cost**: Free to $27/month

### 2. Render.com (All-in-One)
- **Full-stack**: Both frontend and backend on Render
- **Guide**: See below
- **Cost**: Free tier available (backend sleeps after 15 mins) or $7/month (always-on)

---

## Option 1: Render.com (All-in-One)

**Architecture**: Full-stack deployment with FastAPI backend and React frontend
**Database**: MongoDB Atlas
**Cost**: Free tier available (backend sleeps after 15 mins) or $7/month (always-on)

## Prerequisites

1. **MongoDB Atlas Account**: Create free cluster at [mongodb.com/atlas](https://mongodb.com/atlas)
2. **GitHub OAuth App**: Register at [github.com/settings/applications/new](https://github.com/settings/applications/new)
3. **Render Account**: Sign up at [render.com](https://render.com) with GitHub

## Deployment Steps

### 1. MongoDB Setup
- Create MongoDB Atlas cluster
- Create database user with read/write permissions
- Whitelist IP addresses (0.0.0.0/0 for development)
- Copy connection string

### 2. GitHub OAuth Setup
- Application Name: `Papers2Code`
- Homepage URL: `https://your-app-name.onrender.com`
- Authorization Callback URL: `https://your-app-name.onrender.com/auth/github/callback`
- Copy Client ID and Client Secret

### 3. Render Deployment
1. Go to [render.com](https://render.com)
2. Click **New** → **Blueprint**
3. Connect GitHub and select repository
4. Review services (backend + frontend)
5. Click **Apply**

### 4. Environment Variables
Set in Render Dashboard → Backend Service → Environment:

```
MONGO_CONNECTION_STRING=mongodb+srv://username:password@cluster.mongodb.net/papers2code
GITHUB_CLIENT_ID=your-github-client-id
GITHUB_CLIENT_SECRET=your-github-oauth-secret
```

## Post-Deployment

### 1. Verify Services
- Backend: `https://your-backend-name.onrender.com/health`
- Frontend: `https://your-frontend-name.onrender.com`

### 2. Test Authentication
- GitHub OAuth login should work
- User registration and login flow

### 3. Database Connection
- Verify MongoDB Atlas connection
- Test paper search and submission

## Services Configuration

The `render.yaml` blueprint creates:
- **papers2code-api**: FastAPI backend (Web Service)
- **papers2code-frontend**: React frontend (Static Site)

## Environment Variables

### Required (Set Manually)
```
MONGO_CONNECTION_STRING=mongodb+srv://...
GITHUB_CLIENT_ID=your-github-client-id
GITHUB_CLIENT_SECRET=your-github-oauth-secret
```

### Auto-Generated by Render
```
ENV_TYPE=production
PORT=5000
FLASK_SECRET_KEY=auto-generated
FRONTEND_URL=auto-linked-to-frontend
VITE_API_BASE_URL=auto-linked-to-backend
```

## Cost

| Service | Free Tier | Paid Tier |
|---------|-----------|-----------|
| Backend | Sleeps after 15min inactivity | $7/month always-on |
| Frontend | Always free | Always free |

## Troubleshooting

### Build Issues
- Check build logs in Render dashboard
- Verify Python version is 3.12+ and uv is properly installed
- Ensure all dependencies are in pyproject.toml
- Check that uv.lock is up to date

### Connection Issues
- Verify MongoDB Atlas IP whitelist (0.0.0.0/0)
- Check GitHub OAuth callback URLs
- Confirm environment variables are set correctly

### Performance
- Free tier backend sleeps after 15 minutes
- First request after sleep takes 30-60 seconds
- Consider paid tier for production use
- **OAuth issues**: Check GitHub app callback URLs

### Debug Commands
```bash
# Check if services are running
curl https://your-backend.onrender.com/health

# Check frontend
curl https://your-frontend.onrender.com
```
