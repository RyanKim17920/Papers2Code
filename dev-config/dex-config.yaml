# Dex Configuration for Papers2Code Development Environment
# This provides a local OpenID Connect provider that simulates GitHub and Google OAuth

issuer: http://localhost:5556/dex

storage:
  type: memory

web:
  http: 0.0.0.0:5556
  # Custom web templates for branding (optional)
  # theme: papers2code

# Enable the password connector for simple dev users
# This creates a mock "static" provider with predefined users
connectors:
  # Mock IDP (Internal Backend Service)
  - type: oidc
    id: mock-idp
    name: Mock Identity Provider
    config:
      issuer: http://host.docker.internal:5000/mock-idp
      clientID: mock-client
      clientSecret: mock-secret
      redirectURI: http://localhost:5556/dex/callback
      getUserInfo: true
      insecureSkipEmailVerified: true
      insecureEnableGroups: true

# OAuth2 clients - your backend will register as a client
oauth2:
  skipApprovalScreen: true  # Auto-approve in dev
  responseTypes: ["code"]
  
staticClients:
  # Papers2Code Backend Client
  - id: papers2code-backend
    redirectURIs:
      - 'http://localhost:5000/api/auth/github/callback'
      - 'http://localhost:5000/api/auth/google/callback'
      - 'http://localhost:5173/auth/callback'  # Direct frontend callback for testing
    name: 'Papers2Code Development'
    secret: dev-client-secret-change-in-production
    
# Static users for development (no real OAuth providers needed)
# WARNING: These accounts are for development/testing only.
enablePasswordDB: true
staticPasswords:
  # Simulate GitHub users
  - email: "dev_github_user1@test.local"
    hash: "$2a$10$2b2cU8CPhOTaGrs1HRQuAueS7JTT5ZHsHSzYiFPm1leZck7Mc8T4W"  # password: "password"
    username: "github_dev_user1"
    userID: "gh-001"
    
  - email: "dev_github_user2@test.local"
    hash: "$2a$10$2b2cU8CPhOTaGrs1HRQuAueS7JTT5ZHsHSzYiFPm1leZck7Mc8T4W"  # password: "password"
    username: "github_dev_user2"
    userID: "gh-002"
    
  - email: "admin_dev@test.local"
    hash: "$2a$10$2b2cU8CPhOTaGrs1HRQuAueS7JTT5ZHsHSzYiFPm1leZck7Mc8T4W"  # password: "password"
    username: "admin_dev"
    userID: "admin-001"
    
  # Simulate Google users
  - email: "dev_google_user1@gmail.test"
    hash: "$2a$10$2b2cU8CPhOTaGrs1HRQuAueS7JTT5ZHsHSzYiFPm1leZck7Mc8T4W"  # password: "password"
    username: "google_dev_user1"
    userID: "gg-001"
    
  - email: "dev_google_user2@gmail.test"
    hash: "$2a$10$2b2cU8CPhOTaGrs1HRQuAueS7JTT5ZHsHSzYiFPm1leZck7Mc8T4W"  # password: "password"
    username: "google_dev_user2"
    userID: "gg-002"

# Expiry times for tokens (short in dev for testing)
expiry:
  signingKeys: "6h"
  idTokens: "24h"
  authRequests: "24h"
  deviceRequests: "5m"

logger:
  level: "debug"
  format: "text"

# Frontend configuration
frontend:
  issuer: Papers2Code Dev
  logoURL: https://via.placeholder.com/150?text=P2C
  theme: light
